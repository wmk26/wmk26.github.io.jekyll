---
layout: post
title: 最大似然估计（Maximum Likelihood Estimation）
date: 2017-09-19
categories: machine learning
tags: machine learning
---

## 0. 名词解释

### 0.1 似然 vs 概率

“似然性”与“或然性”或“概率”意思相近，都是指某种事件发生的可能性，但是在统计学中，“似然性”和“或然性”或“概率”又有明确的区分。概率用于在已知一些参数的情况下，预测接下来的观测所得到的结果，而似然性则是用于在已知某些观测所得到的结果时，对有关事物的性质的参数进行估计。

### 0.2 似然函数

在数理统计学中，似然函数是一种关于统计模型中的参数的函数，表示模型参数中的似然性。

## 1. 最大似然估计

最大似然估计提供了一种给定观察数据来评估模型参数的方法，即：“模型已定，参数未知”。简单理解就是，给定已知事件（比如抛硬币的n次结果），那么在什么情况下该已知事件最有可能发生（抛硬币的正面的概率是多少，会出现已知事件）。

通用求解过程

假设$ x_1,x_2,...,x_n $为独立同分布采样，$ \theta $为模型参数，$ f $为已知的模型。遵循上述的独立同分布假设，产生上述采样的概率可以表示为：

$$
f(x_1,x_2,...,x_n|\theta) = f(x_1|\theta) \times f(x_2|\theta) \times ... \times f(x_n|\theta)
$$

此时已知的是$ x_1,x_2,...,x_n $，未知的是模型的参数$ \theta $，因此似然可以定义为：

$$
L(\theta|x_1,x_2,...,x_n) = f(x_1,x_2,...,x_n|\theta) = \prod_{i=1}^{n} f(x_i|\theta)
$$

由于小数连乘操作可能造成下溢的问题，所以一般会对似然两边同时取对数进行计算，得到如下的形式：

$$
log L(\theta|x_1,x_2,...,x_n) = \sum_{i=1}^{n} log f(x_i|\theta)
$$

那么对参数$ \theta $的最大似然估计为：

$$
\hat{\theta}_{mle} = {\arg\max}_{\theta \in \Theta} \hat{l} (\theta|x_1,x_2,...,x_n)
$$

其中$ \hat{l} = \frac{1}{n} log L$为平均对数似然（其实不求平均也没问题，因为之后是对参数$ \theta $求导，和$ n $无关）。

之后求参数导，导数等于0，求参数即可；

## 2. 最大似然举例

例子1：假设有一个罐子，罐子里面有除颜色意外投相同的黑白两种球，数目未知。每次任意从罐子里面取一个球，记录颜色，放回罐子里面。重复10次，假设7次白球，3次黑球，那么罐子里面白球的比例最有可能是多少？答案是70%。可以用最大似然估计进行理论解释。

由于只有两种颜色的球，可以假设白球的概率服从二项分布（模型已知）。假设白球比例为$ p $，黑球比例为$ 1 - p $。按照最大似然估计，可以写出似然函数为：

$$
L(p|x_1,x_2,...,x_10) = \prod_{i=1}^{10} f(x_i|\theta) = p^{7} \times (1-p)^3
$$

取对数，求导，令导数等于0，可以求得$ p = 0.7 $。

个人理解：产生上述7个白球和3个黑球的结果，白球比例可能有很多种，只不过最有可能是白球比例是70%而已。

例子2：正态分布

假设采样$ x_1,x_2,...,x_n $服从正态分布，且标准差已知。求当正态分布的期望是多少时？产生这个采样数据的概率最大？

参数的似然函数写作如下形式：

$$
L(\theta|x_1,x_2,...,x_n) = \prod_{i=1}^{n} f(x_i|\theta)
$$

正态分布的概率密度函数如下($ \mu $为期望，$ \sigma $为标准差)：

$$
f(x) = \frac{1}{\sqrt{2 \pi}\sigma} exp (- \frac{(x-\mu)^2}{2{\sigma}^2})
$$

带入似然函数中，然后取对数，得到如下结果：

$$
log L(\theta|x_1,x_2,...,x_n) = \lgroup{\frac{1}{\sqrt{2\pi}\sigma}}\rgroup^n exp \lgroup-\frac{1}{2\sigma^2} \sum_{i=0}^{n}(x-\mu)^2\rgroup
$$

求导，令导数等于0，求导结果为：

$$
\mu = \frac{1}{n} \sum_{i=1}^{n}x_i
$$

## 参考文献

- [最大似然估计(Maximum likelihood estimation)](http://www.cnblogs.com/liliu/archive/2010/11/22/1883702.html)(主要参考文献)
- [似然函数](https://zh.wikipedia.org/wiki/%E4%BC%BC%E7%84%B6%E5%87%BD%E6%95%B0?oldformat=true)
- [似然与极大似然估计](http://fangs.in/post/thinkstats/likelihood/)(对概率和似然解释的比较清楚)
- [深入浅出最大似然估计（Maximum Likelihood Estimation）](http://www.jianshu.com/p/f1d3906e4a3e)
